(this.webpackJsonpthef2e_bus=this.webpackJsonpthef2e_bus||[]).push([[0],{10:function(t,e,n){t.exports={container:"Header_container__1VC87",logo:"Header_logo__3_SJs",icon:"Header_icon__2vvCF",menu:"Header_menu__BQHSW"}},17:function(t,e,n){t.exports={container:"SearchPanel_container__3lcqd",wrappers:"SearchPanel_wrappers__3TeiR",searchResult:"SearchPanel_searchResult__4VC11"}},18:function(t,e,n){t.exports={container:"SearchResult_container__1NDtF",result:"SearchResult_result__3N_36",route:"SearchResult_route__2CSeA"}},19:function(t,e,n){t.exports={tabs:"Tabs_tabs__HvDAh",tab_list:"Tabs_tab_list__3tTz_",tab_content:"Tabs_tab_content__2QbBC"}},20:function(t,e,n){t.exports={container:"SearchResultPages_container__2rSOy",stops:"SearchResultPages_stops__1nIva"}},24:function(t,e,n){t.exports={container:"Keyboard_container__3nYJf",button:"Keyboard_button__9VP0N"}},25:function(t,e,n){t.exports={tab_list_item:"Tab_tab_list_item__2AHkI",tab_list_active:"Tab_tab_list_active__IoOUR"}},38:function(t,e,n){t.exports={container:"Footer_container__st7Zp"}},39:function(t,e,n){t.exports={container:"Map_container__3xh_q"}},46:function(t,e,n){},74:function(t,e,n){t.exports={container:"BusSchedule_container__1itXa"}},75:function(t,e,n){"use strict";n.r(e);var a=n(1),c=n.n(a),r=n(15),o=n.n(r),i=(n(46),n(4)),s=n.n(i),u=n(7),l=n(3),p=n(9),j=n.n(p),b=n(10),h=n.n(b),d=n(35),f=n(37),O="\u81fa\u5317\u5e02:Taipei\n\u65b0\u5317\u5e02:NewTaipei\n\u6843\u5712\u5e02:Taoyuan\n\u81fa\u4e2d\u5e02:Taichung\n\u81fa\u5357\u5e02:Tainan\n\u9ad8\u96c4\u5e02:Kaohsiung\n\u57fa\u9686\u5e02:Keelung\n\u65b0\u7af9\u5e02:Hsinchu\n\u65b0\u7af9\u7e23:HsinchuCounty\n\u82d7\u6817\u7e23:MiaoliCounty\n\u5f70\u5316\u7e23:ChanghuaCounty\n\u5357\u6295\u7e23:NantouCounty\n\u96f2\u6797\u7e23:YunlinCounty\n\u5609\u7fa9\u7e23:ChiayiCounty\n\u5609\u7fa9\u5e02:Chiayi\n\u5c4f\u6771\u7e23:PingtungCounty\n\u5b9c\u862d\u7e23:YilanCounty\n\u82b1\u84ee\u7e23:HualienCounty\n\u81fa\u6771\u7e23:TaitungCounty\n\u91d1\u9580\u7e23:KinmenCounty\n\u6f8e\u6e56\u7e23:PenghuCounty\n\u9023\u6c5f\u7e23:LienchiangCounty".split(/\r?\n/).map((function(t){return t.split(":")})),v=n(5),_=n(16),x=n.n(_),m=n(40);function S(){var t=(new Date).toGMTString(),e=new m.a("SHA-1","TEXT");return e.setHMACKey("0o53fh7JHKpoZBW2kIM8SM7GW4Y","TEXT"),e.update("x-date: "+t),{Authorization:'hmac username="83fc39f9c29946578ee26c17b458f970", algorithm="hmac-sha1", headers="x-date", signature="'+e.getHMAC("B64")+'"',"X-Date":t}}function y(){return(y=Object(u.a)(s.a.mark((function t(e){var n;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,x.a.defaults.baseURL="https://ptx.transportdata.tw/MOTC",x.a.defaults.headers=S(),t.next=5,x.a.get(e);case 5:if(200!==(n=t.sent).status){t.next=8;break}return t.abrupt("return",n.data);case 8:t.next=13;break;case 10:t.prev=10,t.t0=t.catch(0),console.log(t.t0);case 13:return t.abrupt("return",null);case 14:case"end":return t.stop()}}),t,null,[[0,10]])})))).apply(this,arguments)}var g=function(t){return y.apply(this,arguments)},N=n(0),w=function(){var t=O.map((function(t,e){return Object(N.jsx)("option",{value:t[1],children:t[0]},e)})),e=Object(a.useState)([]),n=Object(l.a)(e,2),c=n[0],r=(n[1],Object(v.b)()),o=function(){var t=Object(u.a)(s.a.mark((function t(e){return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return null,t.next=3,g("/v2/Bus/Route/City/".concat(e,"?$top=30")).then((function(t){t}));case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();return Object(a.useEffect)((function(){}),[]),Object(N.jsxs)("div",{className:h.a.container,children:[Object(N.jsxs)("div",{className:h.a.logo,children:[Object(N.jsx)(d.a,{className:h.a.icon,icon:f.a}),Object(N.jsx)("p",{children:"Taiwan Bus"})]}),Object(N.jsxs)("div",{className:h.a.menu,children:[Object(N.jsx)("p",{children:"\u7e23\u5e02\uff1a"}),Object(N.jsxs)("select",{onChange:function(t){var e=t.target.value;r({type:"Country",payload:{country:t.target.value}}),o(e)},children:[Object(N.jsx)("option",{disabled:!0,selected:!0,value:!0,children:"\u8acb\u9078\u64c7\u7e23\u5e02"}),t]}),Object(N.jsxs)("select",{onChange:function(){},children:[Object(N.jsx)("option",{disabled:!0,selected:!0,value:!0,children:"\u7ad9\u9ede"}),c]})]})]})},C=n(38),T=n.n(C),P=function(){return Object(N.jsx)("div",{className:T.a.container,children:"\u5168\u53f0\u516c\u8eca\u52d5\u614b\u6642\u523b\u67e5\u8a62\u61c9\u7528\u670d\u52d9"})},R=(n(73),n(8)),k=n.n(R),E=n(39),Z=n.n(E),B=function(t){t.country;var e=Object(a.useRef)(),n=Object(v.c)((function(t){return t.stops}));return Object(a.useEffect)((function(){var t=k.a.map(e.current,{center:[21,123],zoom:16});k.a.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:'&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'}).addTo(t);var a=new k.a.Icon({iconUrl:"https://cdn.rawgit.com/pointhi/leaflet-color-markers/master/img/marker-icon-2x-green.png",shadowUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/0.7.7/images/marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],shadowSize:[41,41]});if(null!==n){n.forEach((function(e){e.Stops.forEach((function(e,n){k.a.marker([e.StopPosition.PositionLat,e.StopPosition.PositionLon],{icon:a}).addTo(t).bindPopup("<h1>".concat(e.StopName.Zh_tw,"</h1>"))}))})),console.log(n),console.log(n[0].Stops[0].StopPosition.PositionLat),console.log(n[0].Stops[0].StopPosition.PositionLon);var c=k.a.latLng(n[0].Stops[0].StopPosition.PositionLat,n[0].Stops[0].StopPosition.PositionLon),r=k.a.latLng(n[0].Stops[n[0].Stops.length-1].StopPosition.PositionLat,n[0].Stops[n[0].Stops.length-1].StopPosition.PositionLon);t.fitBounds([c,r])}return function(){return t.remove()}})),Object(N.jsx)("div",{className:Z.a.container,ref:function(t){return e.current=t}})},A=n(17),H=n.n(A),L=n(24),M=n.n(L),I=function(t){var e=t.onChange;function n(t){e(t.target.innerText)}var a=["\u7d05","\u85cd","\u7da0","\u68d5","\u6a58","\u5c0f","\u5e02\u6c11","1","2","3","\u5357\u8edf","\u591c\u9593","4","5","6","\u901a\u52e4","\u5167\u79d1","7","8","9","\u66f4\u591a","\u5e79\u7dda","\u91cd\u8a2d","0","\u641c\u5c0b"].map((function(t,e){return Object(N.jsx)("div",{className:M.a.button,onClick:n,children:t},e)}));return Object(N.jsx)("div",{className:M.a.container,children:a})},J=n(18),D=n.n(J),K=function(t){var e=t.country,n=t.data,a=Object(v.b)(),c=null===n||void 0===n?void 0:n.map((function(t){return Object(N.jsxs)("div",{className:D.a.result,onClick:function(){return n=t,void g("/v2/Bus/StopOfRoute/City/".concat(e,"/").concat(n.RouteName.Zh_tw)).then((function(t){a({type:"Stops",payload:{stops:t}})}));var n},children:[Object(N.jsx)("div",{children:t.RouteName.Zh_tw}),Object(N.jsxs)("div",{className:D.a.route,children:[Object(N.jsx)("div",{children:t.DepartureStopNameZh}),Object(N.jsx)("div",{children:t.DestinationStopNameZh})]})]})}));return Object(N.jsx)("div",{className:D.a.container,children:c})},$=function(){var t=O.map((function(t,e){return Object(N.jsx)("option",{value:t[1],children:t[0]},e)})),e=Object(a.useState)(""),n=Object(l.a)(e,2),c=n[0],r=n[1],o=Object(a.useState)(""),i=Object(l.a)(o,2),s=i[0],u=i[1],p=Object(a.useState)(null),j=Object(l.a)(p,2),b=j[0],h=j[1];return Object(N.jsx)("div",{className:H.a.container,children:Object(N.jsxs)("div",{className:H.a.wrappers,children:[Object(N.jsxs)("select",{onChange:function(t){u(t.target.value)},children:[Object(N.jsx)("option",{disabled:!0,selected:!0,value:!0,children:"\u8acb\u9078\u64c7\u7e23\u5e02"}),t]}),Object(N.jsxs)("div",{children:["\u641c\u5c0b",Object(N.jsx)("input",{type:"text",value:c})]}),Object(N.jsx)("div",{children:Object(N.jsx)(I,{onChange:function(t){"\u91cd\u8a2d"===t?r(""):"\u641c\u5c0b"===t?g("/v2/Bus/Route/City/".concat(s,"?$filter=contains(RouteName/Zh_tw,'").concat(c,"')&$top=30&$format=JSON")).then((function(t){h(t)})):r(c+t)}})}),Object(N.jsxs)("div",{className:H.a.searchResult,children:["\u641c\u5c0b\u7d50\u679c",Object(N.jsx)("div",{children:Object(N.jsx)(K,{country:s,data:b})})]})]})})},q=n(25),z=n.n(q),F=function(t){var e=t.activeTab,n=t.label,a=t.onClick,c=z.a.tab_list_item;return e===n&&(c+=" "+z.a.tab_list_active),Object(N.jsx)("li",{className:c,onClick:function(){a(n)},children:n})},U=n(19),X=n.n(U),Y=function(t){var e=t.children,n=Object(a.useState)(e[0].props.label),c=Object(l.a)(n,2),r=c[0],o=c[1],i=function(t){o(t)};return Object(N.jsxs)("div",{className:X.a.tabs,children:[Object(N.jsx)("ol",{className:X.a.tab_list,children:e.map((function(t){var e=t.props.label;return Object(N.jsx)(F,{activeTab:r,label:e,onClick:i},e)}))}),Object(N.jsx)("div",{className:X.a.tab_content,children:e.map((function(t){if(t.props.label===r)return t.props.children}))})]})},Q=n(12),V=n(20),W=n.n(V),G=(n(74),function(){var t=Object(v.c)((function(t){return t.stops})),e=Object(a.useState)(!1),n=Object(l.a)(e,2),c=n[0],r=n[1];return Object(a.useEffect)((function(){if(null!==t){r(!0);var e=function(){var e=Object(u.a)(s.a.mark((function e(){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g("/v2/Bus/Schedule/City/".concat(t[0].City,"/").concat(t[0].RouteName.Zh_tw,"?$format=JSON")).then((function(t){console.log(t);t[0],t[1]}));case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();e()}}),[t,c]),c?Object(N.jsx)("div",{children:"\u5f62\u6210"}):Object(N.jsx)(N.Fragment,{})}),tt=function(t){return t.StopName.Zh_tw},et=function(){var t=Object(v.c)((function(t){return t.stops})),e=Object(a.useState)(!1),n=Object(l.a)(e,2),c=n[0],r=n[1],o=Object(a.useState)(null),i=Object(l.a)(o,2),p=i[0],j=i[1],b=Object(a.useState)(null),h=Object(l.a)(b,2),d=h[0],f=h[1],O=Object(a.useState)(""),_=Object(l.a)(O,2),x=_[0],m=_[1],S=Object(a.useState)(""),y=Object(l.a)(S,2),w=y[0],C=y[1];return Object(a.useEffect)((function(){if(null!==t){r(!0);var e=t[0].Stops,n=t[1].Stops;m(tt(e[0])+"->"+tt(e[e.length-1])),C(tt(n[0])+"->"+tt(n[n.length-1]));var a=function(){var e=Object(u.a)(s.a.mark((function e(){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g("/v2/Bus/EstimatedTimeOfArrival/City/".concat(t[0].City,"/").concat(t[0].RouteName.Zh_tw,"?$format=JSON")).then((function(e){var n=[],a=[];e.forEach((function(e){0===e.Direction?t[0].Stops.forEach((function(t){if(t.StopName.Zh_tw===e.StopName.Zh_tw)return n.push(Object(Q.a)(Object(Q.a)({},t),e)),!1})):t[1].Stops.forEach((function(t){if(t.StopName.Zh_tw===e.StopName.Zh_tw)return a.push(Object(Q.a)(Object(Q.a)({},t),e)),!1}))})),n.sort((function(t,e){return t.StopSequence-e.StopSequence})),a.sort((function(t,e){return t.StopSequence-e.StopSequence})),j(n.map((function(t,e){var n=0,a=Object(N.jsx)("div",{children:"\u5df2\u904e\u7ad9"});return t.hasOwnProperty("EstimateTime")&&(n=parseInt(t.EstimateTime),a=Object(N.jsx)("div",{children:"\u9810\u4f30: ".concat(n)})),Object(N.jsxs)("div",{className:W.a.stops,children:[Object(N.jsx)("div",{children:tt(t)},e),a]})}))),f(a.map((function(t,e){var n=0,a=Object(N.jsx)("div",{children:"\u5df2\u904e\u7ad9"});return t.hasOwnProperty("EstimateTime")&&(a=(n=parseInt(t.EstimateTime)/60)<=1?Object(N.jsx)("div",{children:"\u5373\u5c07\u9032\u7ad9"}):Object(N.jsx)("div",{children:"\u9810\u4f30: ".concat(n," \u5206\u9418")})),Object(N.jsxs)("div",{className:W.a.stops,children:[Object(N.jsx)("div",{children:tt(t)},e),a]})})))}));case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();a()}}),[t,c]),c?Object(N.jsxs)("div",{className:W.a.container,children:[Object(N.jsxs)(Y,{children:[Object(N.jsx)("div",{label:x,children:p}),Object(N.jsx)("div",{label:w,children:d})]}),Object(N.jsx)(G,{})]}):Object(N.jsx)(N.Fragment,{children:"\u5c1a\u672a\u641c\u5c0b"})};var nt=function(){var t=Object(v.c)((function(t){return t.country})),e=Object(a.useState)([]),n=Object(l.a)(e,2),c=n[0],r=n[1];return Object(a.useEffect)((function(){var e=function(){var e=Object(u.a)(s.a.mark((function e(){var n,a;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=null,a=null,e.next=4,g("/v2/Bus/Route/City/".concat(t,"?$top=30")).then((function(t){n=t}));case 4:return e.next=6,g("/v2/Bus/Route/City/".concat(t,"/").concat(n[0].RouteName.Zh_tw)).then((function(t){a=t}));case 6:r(a[0]);case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();e()}),[t]),Object(N.jsxs)("div",{className:j.a.container,children:[Object(N.jsx)("div",{className:j.a.header,children:Object(N.jsx)(w,{})}),Object(N.jsxs)("div",{className:j.a.wrapper,children:[Object(N.jsx)($,{}),Object(N.jsxs)("div",{children:[Object(N.jsx)(et,{}),Object(N.jsx)(B,{countries:c})]})]}),Object(N.jsx)("div",{className:j.a.footer,children:Object(N.jsx)(P,{})})]})},at=n(41),ct={country:"NewTaipei",stops:null},rt=Object(at.a)((function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ct,e=arguments.length>1?arguments[1]:void 0;switch(e.type){case"Country":var n=Object.assign({},t);return n.country=e.payload.country,n;case"Stops":var a=Object.assign({},t);return a.stops=e.payload.stops,a;default:return t}}));o.a.render(Object(N.jsx)(c.a.StrictMode,{children:Object(N.jsx)(v.a,{store:rt,children:Object(N.jsx)(nt,{})})}),document.getElementById("root"))},9:function(t,e,n){t.exports={container:"App_container__1MQN3",header:"App_header__3ZZ1n",footer:"App_footer__29Fsv",wrapper:"App_wrapper__2Rh_f"}}},[[75,1,2]]]);
//# sourceMappingURL=main.ca711668.chunk.js.map